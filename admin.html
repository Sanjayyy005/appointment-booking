<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Appointments</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        h1 {
            color: #333;
            font-size: 28px;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-success {
            background: #4caf50;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 36px;
            margin-bottom: 8px;
        }
        
        .stat-card p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .search-filter {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .search-filter input,
        .search-filter select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            flex: 1;
            min-width: 200px;
        }
        
        .search-filter input:focus,
        .search-filter select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th {
            background: #f5f5f5;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #ddd;
            white-space: nowrap;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            color: #555;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .status-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-confirmed {
            background: #d4edda;
            color: #155724;
        }
        
        .action-btn {
            padding: 6px 12px;
            margin-right: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: opacity 0.2s;
        }
        
        .action-btn:hover {
            opacity: 0.8;
        }
        
        .btn-confirm {
            background: #4caf50;
            color: white;
        }
        
        .btn-delete {
            background: #f44336;
            color: white;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        
        .empty-state h2 {
            margin-bottom: 10px;
            color: #666;
        }
        
        .note {
            background: #f0f7ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            font-size: 14px;
            color: #555;
        }
        
        .note strong {
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• Admin Panel - Appointment Management</h1>
            <div class="btn-group">
                <a href="booking.html">Go to booking</a>
                <button class="btn btn-success" onclick="refreshData()">üîÑ Refresh</button>
                <button class="btn btn-danger" onclick="clearAllAppointments()">üóëÔ∏è Clear All</button>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <h3 id="totalCount">0</h3>
                <p>Total Appointments</p>
            </div>
            <div class="stat-card">
                <h3 id="pendingCount">0</h3>
                <p>Pending</p>
            </div>
            <div class="stat-card">
                <h3 id="confirmedCount">0</h3>
                <p>Confirmed</p>
            </div>
        </div>
        
        <div class="search-filter">
            <input type="text" id="searchInput" placeholder="üîç Search by patient name or doctor...">
            <select id="departmentFilter">
                <option value="">All Departments</option>
                <option value="Cardiology">Cardiology</option>
                <option value="Neurology">Neurology</option>
                <option value="Orthopedics">Orthopedics</option>
                <option value="Pediatrics">Pediatrics</option>
                <option value="Dermatology">Dermatology</option>
                <option value="General Medicine">General Medicine</option>
                <option value="Dentistry">Dentistry</option>
                <option value="ENT">ENT</option>
            </select>
            <select id="statusFilter">
                <option value="">All Status</option>
                <option value="Pending">Pending</option>
                <option value="Confirmed">Confirmed</option>
            </select>
        </div>
        
        <div class="table-container">
            <table id="appointmentsTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Patient Name</th>
                        <th>Department</th>
                        <th>Doctor</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="appointmentsBody">
                </tbody>
            </table>
            
            <div id="emptyState" class="empty-state" style="display: none;">
                <h2>üìã No Appointments Found</h2>
                <p>No appointments have been booked yet or they don't match your filters.</p>
            </div>
        </div>
        
        <div class="note">
            <strong>Instructions:</strong> This admin panel displays all appointments booked through the booking page. Use the search and filter options to find specific appointments. You can confirm pending appointments or delete them as needed.
        </div>
    </div>
    
    <script>
        let allAppointments = [];
        
        function loadAppointments() {
            allAppointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            applyFilters();
        }
        
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const departmentFilter = document.getElementById('departmentFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            
            let filtered = allAppointments.filter(apt => {
                const matchesSearch = apt.name.toLowerCase().includes(searchTerm) || 
                                     apt.doctor.toLowerCase().includes(searchTerm);
                const matchesDepartment = !departmentFilter || apt.department === departmentFilter;
                const matchesStatus = !statusFilter || apt.status === statusFilter;
                
                return matchesSearch && matchesDepartment && matchesStatus;
            });
            
            displayAppointments(filtered);
            updateStats();
        }
        
        function displayAppointments(appointments) {
            const tbody = document.getElementById('appointmentsBody');
            const emptyState = document.getElementById('emptyState');
            
            if (appointments.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            tbody.innerHTML = appointments.map((apt, index) => {
                const appointmentDate = new Date(apt.date);
                const formattedDate = appointmentDate.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td><strong>${apt.name}</strong></td>
                        <td>${apt.department}</td>
                        <td>Dr. ${apt.doctor}</td>
                        <td>${formattedDate}</td>
                        <td>${apt.time}</td>
                        <td>
                            <span class="status-badge ${apt.status === 'Pending' ? 'status-pending' : 'status-confirmed'}">
                                ${apt.status}
                            </span>
                        </td>
                        <td>
                            ${apt.status === 'Pending' ? 
                                `<button class="action-btn btn-confirm" onclick="confirmAppointment(${apt.id})">‚úì Confirm</button>` : 
                                `<span style="color: #4caf50; font-size: 12px;">‚úì Confirmed</span>`
                            }
                            <button class="action-btn btn-delete" onclick="deleteAppointment(${apt.id})">‚úó Delete</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function updateStats() {
            document.getElementById('totalCount').textContent = allAppointments.length;
            document.getElementById('pendingCount').textContent = 
                allAppointments.filter(a => a.status === 'Pending').length;
            document.getElementById('confirmedCount').textContent = 
                allAppointments.filter(a => a.status === 'Confirmed').length;
        }
        
        function confirmAppointment(id) {
            let appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            const index = appointments.findIndex(a => a.id === id);
            
            if (index !== -1) {
                appointments[index].status = 'Confirmed';
                localStorage.setItem('appointments', JSON.stringify(appointments));
                loadAppointments();
            }
        }
        
        function deleteAppointment(id) {
            if (confirm('Are you sure you want to delete this appointment?')) {
                let appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
                appointments = appointments.filter(a => a.id !== id);
                localStorage.setItem('appointments', JSON.stringify(appointments));
                loadAppointments();
            }
        }
        
        function clearAllAppointments() {
            if (confirm('‚ö†Ô∏è WARNING: This will permanently delete ALL appointments!\n\nAre you sure you want to continue?')) {
                localStorage.removeItem('appointments');
                loadAppointments();
                alert('All appointments have been cleared.');
            }
        }
        
        function refreshData() {
            loadAppointments();
            alert('Data refreshed successfully!');
        }
        
        // Event listeners for filters
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('departmentFilter').addEventListener('change', applyFilters);
        document.getElementById('statusFilter').addEventListener('change', applyFilters);
        
        // Load appointments on page load
        loadAppointments();
        
        // Auto-refresh every 5 seconds
        setInterval(loadAppointments, 5000);
    </script>
</body>
</html>